<html lang="pt">
    <head th:replace="~{../static/fragments/head/head.html::head('Re:Donate', 'chat')}"></head>
    <body>

    <div class="container clearfix">

        <div class="people-list" id="people-list">
            <div id="perfil">
                <input type="hidden" id="userId" th:value="${dadosUsuario.id}"/>
                <i th:text="${dadosUsuario.nomeUsuario[0]}" class="userLogo"> User Icon </i>
                <h3 th:text="${dadosUsuario.nomeUsuario}"> Usuario Logado </h3>
            </div>
            <ul class="list" id="usersList">

                <div th:each="doacao : ${doacoesExistentes}">
                    <div th:if="${isDoador}" th:id="'userAppender_' + ${doacao.instituicao.usuarioInstituicao.id} + '_' + ${doacao.id}" class="perfil-card" th:attr="onclick=|selectUser('${doacao.id}', '${doacao.instituicao.usuarioInstituicao.nomeUsuario}', '${doacao.instituicao.usuarioInstituicao.id}')|">
                        <div class="perfil-head">
                            <i th:text="${doacao.instituicao.usuarioInstituicao.nomeUsuario[0]}" class="userLogo"> User Icon </i>
                            <h5 th:text="${doacao.instituicao.usuarioInstituicao.nomeUsuario}"> Usuario Logado </h5>
                        </div>
                        <p th:text="'Doação feita para ' + ${doacao.causaDoacao}"> Causa da doação </p>
                    </div>

                    <div th:unless="${isDoador}" th:id="'userAppender_' + ${doacao.doador.usuarioDoador.id} + '_' + ${doacao.id}" class="perfil-card" th:attr="onclick=|selectUser('${doacao.id}', '${doacao.doador.usuarioDoador.nomeUsuario}', '${doacao.doador.usuarioDoador.id}')|">
                        <div class="perfil-head">
                            <i th:text="${doacao.doador.usuarioDoador.nomeUsuario[0]}" class="userLogo"> User Icon </i>
                            <h5 th:text="${doacao.doador.usuarioDoador.nomeUsuario}"> Usuario Logado </h5>
                        </div>
                        <p th:text="'Doação feita para ' + ${doacao.causaDoacao}"> Causa da doação </p>
                    </div>
                </div>

            </ul>
        </div>

        <div class="chat">
            <div class="chat-header clearfix">
                <i id="selectedUserLogo" class="userLogo"></i>

                <div class="chat-about">
                    <div class="chat-with" id="selectedUserId"></div>
                    <div class="chat-num-messages"></div>
                </div>
                <i class="fa fa-star"></i>
            </div> <!-- end chat-header -->

            <div class="chat-history">
                <ul>

                </ul>

            </div> <!-- end chat-history -->

            <div class="chat-message clearfix">
                <textarea id="message-to-send" name="message-to-send" placeholder="Type your message" rows="3"></textarea>

                <i class="fa fa-file-o"></i> &nbsp;&nbsp;&nbsp;
                <i class="fa fa-file-image-o"></i>

                <button id="sendBtn">Send</button>

            </div> <!-- end chat-message -->

        </div> <!-- end chat -->

    </div> <!-- end container -->

    <script id="message-template" type="text/x-handlebars-template">
        <li class="clearfix">
            <div class="message-data align-right">
                <span class="message-data-time">{{time}}</span> &nbsp; &nbsp;
                <span class="message-data-name">You</span> <i class="fa fa-circle me"></i>
            </div>
            <div class="message other-message float-right">
                {{messageOutput}}
            </div>
        </li>
    </script>

    <script id="message-response-template" type="text/x-handlebars-template">
        <li>
            <div class="message-data">
                <span class="message-data-name"><i class="fa fa-circle online"></i> {{userName}}</span>
                <span class="message-data-time">{{time}}</span>
            </div>
            <div class="message my-message">
                {{response}}
            </div>
        </li>
    </script>

    <script src="http://localhost:8080/js/custom.js"></script>
    <script src="http://localhost:8080/js/chat.js"></script>
    <script th:inline="javascript">
        /*<![CDATA[*/

            let userData = /*[[${dadosUsuario}]]*/ "";

            connectToChat(userData.id);
        /*]]>*/
    </script>
    </body>
</html>
